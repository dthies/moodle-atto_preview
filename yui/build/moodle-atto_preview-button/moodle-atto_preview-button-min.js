YUI.add("moodle-atto_preview-button",function(e,t){var n="atto_preview",r="preview",i=!1;e.namespace("M.atto_preview").Button=e.Base.create("button",e.M.editor_atto.EditorPlugin,[],{initializer:function(){var t=this.addButton({icon:"e/preview",callback:this._toggle});t.set("title",M.util.get_string("pluginname",n)),e.after("windowresize",e.bind(this._fitToScreen,this)),this.toolbar.on("click",e.bind(this._fitToScreen,this))},_toggle:function(e){e.preventDefault();var t=this.buttons[r];t.getData(i)?(this.unHighlightButtons(r),this._setpreview(t)):(this.highlightButtons(r),this._setpreview(t,!0))},_fitToScreen:function(){var e=this.buttons[r];if(!e.getData(i))return;var t=this.get("host");this.preview.setStyles({position:"absolute",height:t.editor.getComputedStyle("height"),width:t.editor.getComputedStyle("width"),top:t.editor.getComputedStyle("top"),left:t.editor.getComputedStyle("left")}),this.preview.setY(this.editor.getY())},_setpreview:function(t,n){var r=this.get("host");n?(this.preview=e.Node.create('<iframe src="'+this.get("previewurl")+"?sesskey="+this.get("sesskey")+"&contextid="+this.get("contextid")+"&content="+encodeURIComponent(r.textarea.get("value"))+'" style="background-color: lightGray"></iframe'),r._wrapper.appendChild(this.preview),r.disablePlugins(),r.enablePlugins(this.name),typeof e.M.atto_fullscreen!="undefined"&&r.enablePlugins("fullscreen")):(this.preview.remove(!0),r.enablePlugins()),t.setData(i,!!n),this._fitToScreen()}},{ATTRS:{previewurl:{value:null},contextid:{value:null},sesskey:{value:null}}})},"@VERSION@",{requires:["moodle-editor_atto-plugin"]});
